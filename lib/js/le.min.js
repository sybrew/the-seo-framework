"use strict";window.tsfLe=function(){function a(){tsfTT.triggerReset()}function b(){for(const a in m){const b=m[a],c=document.getElementById("autodescription-quick[%s]".replace("%s",a));if(c)if(b.isSelect){tsf.selectByValue(c,b.value);const a=c.querySelector("[value=\"0\"]");a&&(a.innerHTML=a.innerHTML.replace("%s",tsf.escapeString(tsf.decodeEntities(b.default))))}else c.value=tsf.decodeEntities(b.value),b.placeholder?.length&&(c.placeholder=tsf.decodeEntities(b.placeholder))}}function c(){return b()}function d(a){const b=document.getElementById(`edit-${a}`);let c="public";if(b?.querySelector("[name=keep_private]")?.checked)c="private";else{const a=b?.querySelector("[name=post_password]")?.value;a?.length&&"0"!==a&&(c="password")}return c}function e(a,b){const c=document.getElementById(`edit-${a}`);b=tsfUtils.debounce(b,20),c?.querySelector("[name=post_password]")?.addEventListener("input",b),c?.querySelector("[name=keep_private]")?.addEventListener("click",b)}function f(a){const b="autodescription-quick[doctitle]",c=document.getElementById(b);if(!c)return;tsfTitle.setInputElement(c);const f=JSON.parse(document.getElementById(`tsfLeTitleData[${a}]`)?.dataset.leTitle||0);if(f&&(tsfTitle.updateStateOf(b,"allowReferenceChange",!f.refTitleLocked),tsfTitle.updateStateOf(b,"defaultTitle",f.defaultTitle.trim()),tsfTitle.updateStateOf(b,"addAdditions",f.addAdditions),tsfTitle.updateStateOf(b,"additionValue",f.additionValue.trim()),tsfTitle.updateStateOf(b,"additionPlacement",f.additionPlacement)),"post"===o){const c=()=>{let c="";switch(d(a)){case"password":c=tsfTitle.protectedPrefix;break;case"private":c=tsfTitle.privatePrefix;break;default:case"public":c=""}tsfTitle.updateStateOf(b,"prefixValue",c)};e(a,c),c()}const g=a=>{const c=(a.originalEvent||a).target,d=c.value?.trim()||"";let e=(tsfTitle.stripTitleTags?tsf.stripTags(d):d)||tsfTitle.untitledTitle;if("tax"===o){const a=f?.termPrefix?.trim()||"";a.length&&(window.isRtl?e=`${e} ${a}`:e=`${a} ${e}`)}e=tsf.escapeString(tsf.decodeEntities(e.trim())),tsfTitle.updateStateOf(b,"defaultTitle",e)},h=document.getElementById(`edit-${a}`);switch(o){case"post":const a=h?.querySelector("[name=post_title]");a&&!n.isFront&&(a.addEventListener("input",g),a.dispatchEvent(new Event("input")));break;case"tax":const b=h?.querySelector("[name=name]");b&&(b.addEventListener("input",g),b.dispatchEvent(new Event("input")))}tsfTT.triggerReset()}function g(a){const b="autodescription-quick[description]",c=document.getElementById(b);if(c){tsfDescription.setInputElement(c);const d=JSON.parse(document.getElementById(`tsfLeDescriptionData[${a}]`)?.dataset.leDescription||0);d&&(tsfDescription.updateStateOf(b,"allowReferenceChange",!d.refDescriptionLocked),tsfDescription.updateStateOf(b,"defaultDescription",d.defaultDescription.trim())),tsfTT.triggerReset()}}function h(a){const b="autodescription-quick[noindex]",c="autodescription-quick[canonical]",e=document.getElementById(b),f=document.getElementById(c),g=new Map,h=1,i=2;let j=0;tsfCanonical.setInputElement(f);const k=JSON.parse(document.getElementById(`tsfLeCanonicalData[${a}]`)?.dataset.leCanonical||0);k&&(tsfCanonical.updateStateOf(c,"allowReferenceChange",!k.refCanonicalLocked),tsfCanonical.updateStateOf(c,"defaultCanonical",k.defaultCanonical.trim()),tsfCanonical.updateStateOf(c,"preferredScheme",k.preferredScheme.trim()),tsfCanonical.updateStateOf(c,"urlStructure",k.urlStructure)),tsfCanonical.enqueueTriggerUnregisteredInput(c);const l=()=>{tsfCanonical.updateStateOf(c,"showUrlPlaceholder",!(j&h||j&i)),tsfCanonical.updateStateOf(c,"urlDataParts",Object.fromEntries(g.entries()))},n=document.getElementById(`edit-${a}`);if(tsfCanonical.usingPermalinks&&f&&n)switch(o){case"post":{const b=tsfCanonical.structIncludes(c,"%postname%"),d=tsfCanonical.structIncludes(c,["%year%","%monthnum%","%day%","%hour%","%minute%","%second%"]),e={},f=tsfCanonical.structIncludes(c,"%author%");let h="",i="",j="",m="",o=[],p=[];b&&(tsfPostSlugs.store(k.parentPostSlugs),o=k.parentPostSlugs.map(a=>a.slug)),k.supportedTaxonomies.forEach(a=>{e[a]=tsfCanonical.structIncludes(c,`%${a}%`)});for(const[a,b]of Object.entries(k.parentTermSlugs))tsfTermSlugs.store(b,a),p[a]=b.map(a=>a.slug);f&&(tsfAuthorSlugs.store(k.authorSlugs),j=k.authorSlugs?.[0].slug);const q=()=>{if(b){let b="";h.length&&(b=tsfCanonical.sanitizeSlug(h.substring(0,200)),"0"===b&&(b="")),!b.length&&i.length&&(b=tsfCanonical.sanitizeSlug(i.substring(0,200))),b.length||(b=a),g.set(`%postname%`,[...o,b].join("/"))}if(g.set(`%post_id%`,a).set(`%author%`,j),d){const a=new Date(m),b=a=>(a+"").padStart(2,"0");g.set(`%year%`,a.getFullYear()).set(`%monthnum%`,b(a.getMonth()+1)).set(`%day%`,b(a.getDate())).set(`%hour%`,b(a.getHours())).set(`%minute%`,b(a.getMinutes())).set(`%second%`,b(a.getSeconds()))}for(const a in e)e[a]&&g.set(`%${a}%`,Object.values(p[a]??{}).join("/"));l()},r=tsfUtils.debounce(q,1e3/60);if(Object.values(e).includes(!0)){const a=tsfUtils.debounce(async a=>{const b=a.detail.taxonomy;e[b]&&(p[b]=await tsfTermSlugs.get(a.detail.id,b),r())},100);document.addEventListener(`tsf-updated-primary-term`,a)}if(b){const a=n.querySelector("[name=post_name]"),b=n.querySelector("[name=post_title]"),c=n.querySelector("[name=post_parent]"),d=()=>{i=b?.value??"",h=a?.value??"",r()};if(a?.addEventListener("input",d),b?.addEventListener("input",d),d(),c){const a=tsfUtils.debounce(async()=>{o=await tsfPostSlugs.get(c.value),r()},100);c.addEventListener("input",a),a()}}if(f){const a=n.querySelector("[name=post_author]");if(a){const b=tsfUtils.debounce(async()=>{j=await tsfAuthorSlugs.get(a.value),r()},100);a.addEventListener("input",b),b()}}if(d){const a=[n.querySelector("[name=aa]"),n.querySelector("[name=mm]"),n.querySelector("[name=jj]"),n.querySelector("[name=hh]"),n.querySelector("[name=mn]"),n.querySelector("[name=ss]")],b=!a.some(a=>null===a),c=()=>{const b=a.map(a=>a.value);return b[1]&&--b[1],b.map(a=>a??"00")},d=()=>{m=b?new Date(...c()).toISOString():k.publishDate,r()};a.forEach(a=>{a?.addEventListener("change",d)}),d()}r();break}case"tax":{const b=n.querySelector("input[name=taxonomy]")?.value||"",d=tsfCanonical.structIncludes(c,`%${b}%`);let e="",f="",h=[];d&&(tsfTermSlugs.store(k.parentTermSlugs,b),h=k.parentTermSlugs.map(a=>a.slug));const i=()=>{if(d){let c="";e.length&&(c=tsfCanonical.sanitizeSlug(e.substring(0,200)),"0"===c&&(c="")),!c.length&&f.length&&(c=tsfCanonical.sanitizeSlug(f.substring(0,200))),c.length||(c=a),g.set(`%${b}%`,[...h,c].join("/"))}l()},j=tsfUtils.debounce(i,1e3/60);if(d){const a=n.querySelector("[name=name]"),b=n.querySelector("[name=slug]"),c=()=>{f=a?.value??"",e=b?.value??"",j()};b?.addEventListener("input",c),a?.addEventListener("input",c),c()}j()}}if(e){if("post"===o){const b=tsfUtils.debounce(()=>{let b=e.querySelector("[value=\"0\"]"),c="";switch(d(a)){case"password":case"private":c="noindex",j|=h;break;default:case"public":c=m.noindex.default,j&=~h}b&&(b.innerHTML=e.dataset.defaultI18n.replace("%s",tsf.escapeString(tsf.decodeEntities(c)))),l()},1e3/60);n?.querySelector("[name=post_password]")?.addEventListener("input",()=>b()),n?.querySelector("[name=keep_private]")?.addEventListener("change",()=>b()),b()}const b=a=>{let b="";switch(+a){case 0:b=m.noindex.default;break;case-1:b="index";break;case 1:b="noindex"}"noindex"===b?j|=i:j&=~i,l()};e.addEventListener("change",a=>b(a.target.value)),b(e.value)}}function i(a){window.tsfPTLE._prepareQuickEditTerms(a,n?.primaryTerms)}function j(){window.tsfPTLE._prepareBulkEditTerms()}function k(){document.addEventListener("tsfLeDispatchUpdate",p),document.addEventListener("tsfLeUpdated",a)}function l(){let a,d;a=window.inlineEditPost?.edit,a&&(window.inlineEditPost.edit=function(c){let d=a.apply(this,arguments);return("object"==typeof c&&(c=window.inlineEditPost?.getId(c)),!c)?d:(o="post",m=JSON.parse(document.getElementById(`tsfLeData[${c}]`)?.dataset.le||0)||{},n=JSON.parse(document.getElementById(`tsfLePostData[${c}]`)?.dataset.lePostData||0)||{},[b,h,f,g,i].forEach(a=>{try{a(c)}catch(a){}}),window.tsfC?.resetCounterListener(),d)}),d=window.inlineEditTax?.edit,d&&(window.inlineEditTax.edit=function(a){const b=d.apply(this,arguments);return("object"==typeof a&&(a=window.inlineEditTax?.getId(a)),!a)?b:(o="tax",m=JSON.parse(document.getElementById(`tsfLeData[${a}]`)?.dataset.le||0)||{},[c,h,f,g].forEach(b=>{try{b(a)}catch(a){}}),window.tsfC?.resetCounterListener(),b)});const e=window.inlineEditPost?.setBulk;e&&(window.inlineEditPost.setBulk=function(){const a=e.apply(this,arguments);return[j].forEach(a=>{try{a()}catch(a){}}),a})}let m,n,o="";const p=tsfUtils.debounce(()=>{document.dispatchEvent(new CustomEvent("tsfLeUpdated"))},50);return{load:()=>{document.body.addEventListener("tsf-onload",k),document.body.addEventListener("tsf-onload",l)}}}(),window.tsfLe.load();
