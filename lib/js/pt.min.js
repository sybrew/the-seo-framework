'use strict';window.tsfPT=function(a){const b="undefined"!=typeof tsfPTL10n&&tsfPTL10n,c=()=>{if(!Object.keys(b.taxonomies).length)return;let c=b.taxonomies,d=wp.template("tsf-primary-term-selector"),e=wp.template("tsf-primary-term-selector-help"),f=document.createElement("span");f.classList.add("tsf-primary-term-selector","tsf-set-primary-term"),(()=>{let a=document.createElement("input");a.setAttribute("type","radio"),f.appendChild(a)})();let g={},h={},i={},j={},k={};const l=(a,b)=>a+".tsfShowPrimary"+b,m=b=>{let e=a("#"+b+"div"),f=d({taxonomy:c[b]});e.append(f)},n=b=>{let d=a("#taxonomy-"+b),f=e({taxonomy:c[b]}),g=d.children("ul:first");g.length?a(f).insertAfter(g):d.prepend(f),tsfTT.triggerReset(),o(b)},o=a=>{let b=document.getElementById("taxonomy-"+a),c=b.querySelectorAll(".tabs-panel"),d=b.closest(".postbox");if(!(d&&d.classList.contains("closed"))){let a=[].slice.call(c).filter(a=>0<a.offsetWidth||0<a.offsetHeight||0<a.getClientRects().length)[0];if(a){let c=a.scrollHeight>a.clientHeight?a.offsetWidth-a.clientWidth+25-2:25;window.isRtl?b.querySelector(".tsf-primary-term-selector-help-wrap").style.left=c+"px":b.querySelector(".tsf-primary-term-selector-help-wrap").style.right=c+"px"}}},p=a=>{o(a.data.taxonomy)},q=a=>{let b=f.cloneNode(!0);return b.setAttribute("title",c[a].i18n.makePrimary),b.setAttribute("aria-label",c[a].i18n.makePrimary),b},r=(a,b)=>{let c=document.getElementById("autodescription[_primary_term_"+a+"]");c&&c instanceof Element&&(c.value=b||0)},s=(b,c)=>!c&&j[b]?j[b]:(j[b]=a("#"+b+"checklist, #"+b+"checklist-pop"),j[b]),t=(a,b)=>g[a].filter("[value=\""+b+"\"]"),u=(a,b)=>{let d=t(a,b).closest("label");d.length?(d.addClass("tsf-is-primary-term"),d.find(".tsf-set-primary-term").each(function(b,d){d.setAttribute("title",c[a].i18n.primary),d.setAttribute("aria-label",c[a].i18n.primary),d.querySelector("input").checked=!0}),r(a,b),k[a]=b):w(a)},v=a=>{let b=s(a).find("label");b.removeClass("tsf-is-primary-term"),b.find(".tsf-set-primary-term").each(function(b,d){d.setAttribute("title",c[a].i18n.makePrimary),d.setAttribute("aria-label",c[a].i18n.makePrimary),d.querySelector("input").checked=!1}),r(a,0),k[a]=0},w=a=>{let b,c=i[a].first();c.length?(b=c.val()||"",u(a,b),k[a]=b):k[a]=0},x=b=>{let c=b.data.taxonomy;return b.target instanceof HTMLInputElement?(b.stopPropagation(),a(b.target).closest(".tsf-set-primary-term").trigger(l("click",c)),!0):(v(c),u(c,a(b.target).closest("label").find("input[type=checkbox]").val()),!1)},y=a=>{let b=a.data.taxonomy;switch(a.target.checked?(B(b,a.target),z(b,a.target)):(C(b,a.target),A(b,a.target)),i[b].length){case 0:v(b);break;case 1:w(b);}},z=(b,c)=>{let d,f;t(b,c.value).each((c,g)=>{d=a(g).closest("label"),d.find(".tsf-primary-term-selector").length||(f=q(b),d.find("input").after(f))})},A=(b,c)=>{let d,f;t(b,c.value).each((c,g)=>{d=a(g).closest("label"),f=d.hasClass("tsf-is-primary-term"),d.removeClass("tsf-is-primary-term"),d.find(".tsf-primary-term-selector").remove(),f&&w(b)})},B=(a,b)=>{h[a]=h[a].add(`[value="${b.value}"]`),i[a]=i[a].add(b)},C=(a,b)=>{h[a]=h[a].not(`[value="${b.value}"]`),i[a]=i[a].not(`[value="${b.value}"]`)},D=a=>{o(a.data.taxonomy)},E=b=>{let c=s(b,1);g[b]=c.find("input[type=checkbox]"),h[b]=c.find("input[type=checkbox]:checked");let d,e={};i[b]=h[b],i[b].each((c,f)=>{d=a(f).val(),e[d]?i[b].splice(c,1):e[d]=!0})},F=(a,b,c)=>{c.hasOwnProperty("settings")&&c.settings.hasOwnProperty("what")&&(E(c.settings.what),G(c.settings.what),H(c.settings.what),o(c.settings.what))},G=b=>{let c={taxonomy:b},d=s(b),e=a(`#${b}div`),f=a(`#${b}-tabs`),g=d.closest(".postbox"),h=l("click",b);d.off(h).on(h,"input[type=\"checkbox\"]",c,y).on(h,".tsf-primary-term-selector",c,x),e.off(l("wpListAddEnd",b)).on(l("wpListAddEnd",b),`#${b}checklist`,F),f.off(h).on(h,"a",c,p),g.off(l("click.postboxes",b)).on(l("click.postboxes",b),c,D)},H=a=>{s(a).find("input[type=\"checkbox\"]:checked").each((b,c)=>{z(a,c)}),k[a]?u(a,k[a]):w(a)},I=a=>{s(a).find("input[type=\"checkbox\"]:checked").each((b,c)=>{z(a,c)}),c[a].primary?u(a,c[a].primary):w(a)};(()=>{for(let a in c)s(a).length&&(m(a),n(a),E(a),G(a),I(a))})()};return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",c)}},{l10n:b})}(jQuery),window.tsfPT.load();
